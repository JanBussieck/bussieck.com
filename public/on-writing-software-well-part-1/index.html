<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.fd2efcc27a2a91f4f6db.css">:root{--color-primary:#3eb0ef;--color-base:#15171a;--color-secondary:#5b7a81;--color-border:#c7d5d8;--color-bg:#f5f5f5;--font-sans-serif:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;--font-serif:Georgia,Times,serif;--font-mono:Menlo,Courier,monospace;--font-light:100;--font-normal:400;--font-bold:700;--font-heavy:800;--height:4rem;--margin:2rem;--radius:0.6rem}a,abbr,acronym,address,applet,article,aside,audio,big,blockquote,body,canvas,caption,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,ul,var,video{margin:0;padding:0;border:0;font:inherit;font-size:100%;vertical-align:baseline}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:after,blockquote:before,q:after,q:before{content:"";content:none}img{max-width:100%}html{box-sizing:border-box;font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}*,:after,:before{box-sizing:inherit}a{background-color:transparent}a:active,a:hover{outline:0}b,strong{font-weight:700}dfn,em,i{font-style:italic}h1{margin:.67em 0;font-size:2em}small{font-size:80%}sub,sup{position:relative;font-size:75%;line-height:0;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}mark{background-color:#fdffb6}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{margin:0;color:inherit;font:inherit}button{overflow:visible;border:none}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{cursor:pointer;-webkit-appearance:button}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}input{line-height:normal}input:focus{outline:none}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{box-sizing:content-box;-webkit-appearance:textfield}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}legend{padding:0;border:0}textarea{overflow:auto}table{border-spacing:0;border-collapse:collapse}td,th{padding:0}html{overflow-y:scroll;font-size:62.5%;background:var(--color-base);-webkit-tap-highlight-color:rgba(0,0,0,0)}body,html{overflow-x:hidden}body{color:#3c484e;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;font-size:1.5rem;line-height:1.6em;font-weight:400;font-style:normal;letter-spacing:0;text-rendering:optimizeLegibility;background:#fff;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-moz-font-feature-settings:"liga" on}::selection{text-shadow:none;background:#cbeafb}hr{position:relative;display:block;width:100%;margin:1.8em 0 2.4em;padding:0;height:1px;border:0;border-top:1px solid #e3e9ed}audio,canvas,iframe,img,svg,video{vertical-align:middle}fieldset{margin:0;padding:0;border:0}textarea{resize:vertical}blockquote,dl,ol,p,ul{margin:0 0 1.5em}ol,ul{padding-left:1.3em;padding-right:1.5em}ol ol,ol ul,ul ol,ul ul{margin:.5em 0 1em}ul{list-style:disc}ol{list-style:decimal}ol,ul{max-width:100%}li{margin:.5em 0;padding-left:.3em;line-height:1.6em}dt{float:left;margin:0 20px 0 0;width:120px;font-weight:500;text-align:right}dd{margin:0 0 5px;text-align:left}blockquote{margin:.3em 0 1.8em;padding:0 1.6em;border-left:.5em solid #cbeafb}blockquote p{margin:.8em 0;font-size:1.2em;font-weight:300}blockquote small{display:inline-block;margin:.8em 0 .8em 1.5em;font-size:.9em;opacity:.8}blockquote small:before{content:"\2014   \A0"}blockquote cite{font-weight:700}blockquote cite a{font-weight:400}a{color:#26a8ed;text-decoration:none}a:hover{text-decoration:underline}h1,h2,h3,h4,h5,h6{margin-top:0;color:var(--color-base);line-height:1.15;font-weight:700;text-rendering:optimizeLegibility}h1{margin:0 0 .5em;font-size:4rem;font-weight:700}@media (max-width:500px){h1{font-size:2rem}}h2{margin:1.5em 0 .5em;font-size:2rem}@media (max-width:500px){h2{font-size:1.8rem}}h3{margin:1.5em 0 .5em;font-size:1.8rem;font-weight:500}@media (max-width:500px){h3{font-size:1.7rem}}h4{margin:1.5em 0 .5em;font-size:1.6rem;font-weight:500}h5,h6{margin:1.5em 0 .5em;font-size:1.4rem;font-weight:500}.viewport{display:flex;flex-direction:column;justify-content:space-between;min-height:100vh}.container{max-width:1120px;margin:0 auto;padding:0 4vw}.content{margin:0 auto;font-size:2rem;line-height:1.7em}.content-body{display:flex;flex-direction:column;font-family:var(--font-serif)}.post-full-content{max-width:720px;margin:0 auto;background:#fff}.post-feature-image img{margin:0 0 3vw;width:100%;height:500px;-o-object-fit:cover;object-fit:cover}.content-body h1,.content-body h2,.content-body h3,.content-body h4,.content-body h5,.content-body h6{font-family:var(--font-sans-serif)}.content-body h1{margin:1em 0 .5em;font-size:3.4rem;font-weight:700}@media (max-width:500px){.content-body h1{font-size:2.8rem}}.content-title{margin:0 0 .8em;font-size:5rem}@media (max-width:500px){.content-title{margin:.8em 0;font-size:3.4rem}.content{font-size:1.8rem}}.content-body h2{margin:.8em 0 .4em;font-size:3.2rem;font-weight:700}@media (max-width:500px){.content-body h2{font-size:2.6rem}}.content-body h3{margin:.5em 0 .2em;font-size:2.8rem;font-weight:700}@media (max-width:500px){.content-body h3{font-size:2.2rem}}.content-body h4{margin:.5em 0 .2em;font-size:2.4rem;font-weight:700}@media (max-width:500px){.content-body h4{font-size:2.2rem}}.content-body h5{display:block;margin:.5em 0;padding:1em 0 1.5em;border:0;font-family:Georgia,serif;color:var(--color-primary);font-style:italic;font-size:3.2rem;line-height:1.35em;text-align:center}.content-body h6{margin:.5em 0 .2em;font-size:2rem;font-weight:700}.content-body figure{margin:.4em 0 1.6em;font-size:2.8rem;font-weight:700}.content-body pre{margin:.4em 0 1.8em;font-size:1.6rem;line-height:1.4em;white-space:pre-wrap;padding:20px;background:var(--color-base);color:#fff;border-radius:12px}.site-head{position:relative;padding-top:20px;padding-bottom:20px;color:#fff;background:#47555e;background-position:50%;background-size:cover}.profile-image{position:absolute;right:15%;bottom:0;max-height:400px}.site-nav-item{display:inline-block;padding:5px 10px;color:#fff;opacity:.7}.site-nav-item:hover{text-decoration:none;opacity:1}.site-nav-icon{height:15px;margin:-5px 0 0}.site-logo{height:25px}.site-mast{justify-content:space-between}.site-mast,.site-mast-right{display:flex;align-items:center}.site-mast-right .site-nav-item:last-child{padding-right:0}.site-banner{max-width:80%;margin:0 auto;padding:10vw 0;text-align:left}.site-banner-title{margin:0;padding:0;color:#fff;font-size:4rem;line-height:1.3em}.site-banner-desc{margin:5px 0 0;padding:0;font-size:2.4rem;line-height:1.3em;opacity:.7}.site-nav{display:flex;align-items:center;justify-content:space-between;margin:15px 0 0}.site-nav-left{margin:0 20px 0 -10px}.site-nav-button{display:inline-block;padding:5px 10px;border:1px solid #fff;color:#fff;font-size:1.3rem;line-height:1em;border-radius:var(--radius);opacity:.7}.site-nav-button:hover{text-decoration:none}.site-main{padding:4vw 0}.post-feed{display:grid;justify-content:space-between;grid-gap:30px;grid-template-columns:1fr 1fr 1fr}@media (max-width:980px){.post-feed{grid-template-columns:1fr 1fr}}@media (max-width:680px){.post-feed{grid-template-columns:1fr}}.post-card{color:inherit}.post-card,.post-card:hover{text-decoration:none}.post-card-tags{margin:0 0 5px;font-size:1.4rem;line-height:1.15em;color:var(--color-secondary)}.post-card-title{margin:0 0 10px;padding:0}.post-card-excerpt{font-size:1.6rem;line-height:1.55em}.post-card-image{margin:0 0 10px;width:auto;height:200px;background:var(--color-secondary) no-repeat 50%;background-size:cover}.post-card-footer{justify-content:space-between;margin:10px 0 0;color:var(--color-secondary)}.post-card-footer,.post-card-footer-left{display:flex;align-items:center}.post-card-footer-right{display:flex;flex-direction:column}.post-card-avatar{width:30px;height:30px;margin:0 7px 0 0;border-radius:100%;display:flex;align-items:center;justify-content:center}.post-card-avatar .author-profile-image{display:block;width:100%;background:var(--color-secondary);border-radius:100%;-o-object-fit:cover;object-fit:cover}.post-card-avatar .default-avatar{width:26px}.tag-header{max-width:690px;margin:0 0 4vw}.tag-header h1{margin:0 0 1rem}.tag-header p{margin:0;color:var(--color-secondary);font-size:2.2rem;line-height:1.3em}@media (max-width:500px){.tag-header{border-bottom:1px solid var(--color-bg);padding-bottom:4vw}.tag-header p{font-size:1.7rem}}.author-header{display:flex;justify-content:space-between;margin:0 0 4vw}.author-header h1{margin:0 0 1rem}.author-header p{margin:0;color:var(--color-secondary);font-size:2.2rem;line-height:1.3em}.author-header-image{flex:0 0 auto;margin:0 0 0 4vw;height:120px;width:120px;border-radius:100%;overflow:hidden}.author-header-meta{display:flex;margin:1rem 0 0}.author-header-item{display:block;padding:2px 10px}.author-header-item:first-child{padding-left:0}@media (max-width:500px){.author-header{border-bottom:1px solid var(--color-bg);padding-bottom:4vw}.author-header p{font-size:1.7rem}.author-header-image{height:80px;width:80px}}.pagination{position:relative;display:flex;justify-content:space-between;align-items:center;margin:4vw 0 0}.pagination a{display:inline-block;padding:10px 15px;border:1px solid var(--color-border);color:var(--color-secondary);text-decoration:none;font-size:1.4rem;line-height:1em;border-radius:var(--radius)}.pagination-location{position:absolute;left:50%;width:100px;margin-left:-50px;text-align:center;color:var(--color-secondary);font-size:1.3rem}.site-foot{padding:20px 0 40px;color:hsla(0,0%,100%,.7);font-size:1.3rem;background:var(--color-base)}.site-foot-nav{display:flex;align-items:center;justify-content:space-between}.site-foot-nav a{color:hsla(0,0%,100%,.7)}.site-foot-nav a:hover{text-decoration:none;color:#fff}.site-foot-nav-right a{display:inline-block;padding:2px 5px}.site-foot-nav-right a:last-child{padding-right:0}.kg-bookmark-card{width:100%;margin-top:0}.kg-bookmark-container{display:flex;min-height:148px;font-family:var(--font-sans-serif);border-radius:3px}.kg-bookmark-container,.kg-bookmark-container:hover{color:var(--color-base);text-decoration:none;box-shadow:0 2px 5px -1px rgba(0,0,0,.15),0 0 1px rgba(0,0,0,.09)}.kg-bookmark-content{flex-grow:1;display:flex;flex-direction:column;justify-content:flex-start;align-items:flex-start;padding:20px}.kg-bookmark-title{color:color(var(--color-secondary) l(-30%));font-size:1.6rem;line-height:1.5em;font-weight:600;-webkit-transition:color .2s ease-in-out;transition:color .2s ease-in-out}.kg-bookmark-container:hover .kg-bookmark-title{color:var(--color-primary)}.kg-bookmark-description{display:-webkit-box;overflow-y:hidden;margin-top:12px;max-height:48px;color:color(var(--color-secondary) l(-10%));font-size:1.5rem;line-height:1.5em;font-weight:400;-webkit-line-clamp:2;-webkit-box-orient:vertical}.kg-bookmark-thumbnail{position:relative;min-width:33%;max-height:100%}.kg-bookmark-thumbnail img{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:0 3px 3px 0;-o-object-fit:cover;object-fit:cover}.kg-bookmark-metadata{display:flex;flex-wrap:wrap;align-items:center;margin-top:14px;color:color(var(--color-secondary) l(-10%));font-size:1.5rem;font-weight:400}.kg-bookmark-icon{margin-right:8px;width:22px;height:22px}.kg-bookmark-author{line-height:1.5em}.kg-bookmark-author:after{content:"\2022";margin:0 6px}.kg-bookmark-publisher{overflow:hidden;max-width:240px;line-height:1.5em;text-overflow:ellipsis;white-space:nowrap}</style><meta name="generator" content="Gatsby 2.19.23"/><link rel="shortcut icon" href="/icons/icon-48x48.png"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#15171A"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png"/><link rel="alternate" type="application/rss+xml" href="/rss"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><title data-react-helmet="true">Ruby on Rails: Writing Software Well Part 1</title><link data-react-helmet="true" rel="canonical" href="https://gatsby.ghost.org/on-writing-software-well-part-1/"/><meta data-react-helmet="true" name="description" content="Part 1 deals with expressive constants and code colocation and the dos and donts of using exception as control flow."/><meta data-react-helmet="true" property="og:site_name" content="bussieck.com"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="Ruby on Rails: Writing Software Well Part 1"/><meta data-react-helmet="true" property="og:description" content="We&#x27;re looking at DHH&#x27;s series to talk about software design using real world software with alls its trade-offs, necessary messiness and complexity so neatly omitted in your standard textbook toy examples."/><meta data-react-helmet="true" property="og:url" content="https://gatsby.ghost.org/on-writing-software-well-part-1/"/><meta data-react-helmet="true" property="article:published_time" content="2020-03-19T15:57:00.000+00:00"/><meta data-react-helmet="true" property="article:modified_time" content="2020-03-19T21:24:54.000+00:00"/><meta data-react-helmet="true" property="article:tag" content="Ruby on Rails"/><meta data-react-helmet="true" property="article:tag" content="Software Design"/><meta data-react-helmet="true" property="article:tag" content="Tech"/><meta data-react-helmet="true" name="twitter:title" content="Ruby on Rails: Writing Software Well Part 1"/><meta data-react-helmet="true" name="twitter:description" content="We&#x27;re looking at DHH&#x27;s series to talk about software design using real world software with alls its trade-offs, necessary messiness and complexity so neatly omitted in your standard textbook toy examples."/><meta data-react-helmet="true" name="twitter:url" content="https://gatsby.ghost.org/on-writing-software-well-part-1/"/><meta data-react-helmet="true" name="twitter:label1" content="Written by"/><meta data-react-helmet="true" name="twitter:data1" content="Jan Bussieck"/><meta data-react-helmet="true" name="twitter:label2" content="Filed under"/><meta data-react-helmet="true" name="twitter:data2" content="Ruby on Rails"/><meta data-react-helmet="true" name="twitter:site" content="https://twitter.com/tryghost/"/><meta data-react-helmet="true" name="twitter:creator" content="@tryghost"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:image" content="https://images.unsplash.com/photo-1556742044-3c52d6e88c62?ixlib=rb-1.2.1&amp;q=80&amp;fm=jpg&amp;crop=entropy&amp;cs=tinysrgb&amp;w=2000&amp;fit=max&amp;ixid=eyJhcHBfaWQiOjExNzczfQ"/><meta data-react-helmet="true" property="og:image" content="https://images.unsplash.com/photo-1556742044-3c52d6e88c62?ixlib=rb-1.2.1&amp;q=80&amp;fm=jpg&amp;crop=entropy&amp;cs=tinysrgb&amp;w=2000&amp;fit=max&amp;ixid=eyJhcHBfaWQiOjExNzczfQ"/><meta data-react-helmet="true" property="og:image:width" content="1000"/><meta data-react-helmet="true" property="og:image:height" content="523"/><script data-react-helmet="true" type="application/ld+json">{
    "@context": "https://schema.org/",
    "@type": "Article",
    "author": {
        "@type": "Person",
        "name": "Jan Bussieck",
        "image": "//www.gravatar.com/avatar/e056f0b055ea37bd94fdc1664fca6e3d?s=250&d=mm&r=x"
    },
    "keywords": "Ruby on Rails, Software Design, Tech",
    "headline": "Ruby on Rails: Writing Software Well Part 1",
    "url": "https://gatsby.ghost.org/on-writing-software-well-part-1/",
    "datePublished": "2020-03-19T15:57:00.000+00:00",
    "dateModified": "2020-03-19T21:24:54.000+00:00",
    "image": {
        "@type": "ImageObject",
        "url": "https://images.unsplash.com/photo-1556742044-3c52d6e88c62?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=2000&fit=max&ixid=eyJhcHBfaWQiOjExNzczfQ",
        "width": 1000,
        "height": 523
    },
    "publisher": {
        "@type": "Organization",
        "name": "bussieck.com",
        "logo": {
            "@type": "ImageObject",
            "url": "http://localhost:2368/content/images/2020/03/logo.png",
            "width": 60,
            "height": 60
        }
    },
    "description": "Part 1 deals with expressive constants and code colocation and the dos and donts of using exception as control flow.",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://gatsby.ghost.org"
    }
}</script><style data-react-helmet="true" type="text/css">null</style><link as="script" rel="preload" href="/webpack-runtime-f5ff7ac54940d4ab2b0c.js"/><link as="script" rel="preload" href="/app-4296c3cc3365a22cc881.js"/><link as="script" rel="preload" href="/styles-2acafc6230acb47fb120.js"/><link as="script" rel="preload" href="/commons-7ac7283004168054c04b.js"/><link as="script" rel="preload" href="/component---src-templates-post-js-9fc98819e1f892725836.js"/><link as="fetch" rel="preload" href="/page-data/on-writing-software-well-part-1/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="viewport"><div class="viewport-top"><header class="site-head"><img src="/static/jan-bussieck-gray-f98aa166bc686f2ac09e0960372076b8.png" class="profile-image"/><div class="container"><div class="site-mast"><div class="site-mast-left"><a href="/"><img class="site-logo" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAACBCAYAAACFD/U6AAAAAXNSR0IArs4c6QAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAACiJJREFUeAHtXYuR2zoMjDNpIGnmasg19ZKm8mp4zVxKuMe9MRyGJiVKXIiktDfj0Y8EgQWWACXZd/tE/Pv9+/eP9/f3f4gipxB1u91+7lV0Rrxa7AVOweb/gowXbGPcvn379m98PML+lxGUkA5zIbBE6hrygByw2LZmfZhgP87jOCZPT+LcTDnG9u3t7Z0hZzYZNUFRsmkp2Ep9ZjnfgkvORpDmaLJQMwgAObPDc07TuTICaSy0Eib0f7EscxRZqAQpQ6UrQuCjbPpYn7YSBVgaWbyJohKLELktDk9nWYI604howS1n5NevX3/kzrec+9zSOe3LNjiVr+NzIYDJgTlB4C5qWAd/Z6JEJQhTMcm6DgJMktxLLxpRqARhGnqd8JClQACxw4wfEIWRTagEUYmlYG9FYDSSUAnSCo76CwEgMBJJqARhGqZQuTYCzFhqKbeoBFGJde2gHtn6vSShEmRkgKTbfAgwswis30MSKkHYBs3nUmnMRoAdUyDJFh2pBFGJtQV6ta1FgE2SLbd/qQSpNVjthEBPBLaUWiJIT09p7GoE2FmkdmDqy4q1g25t5/VNRXZJuPVluXuq/7UVj7X2bLtsvF5BauOz7Qr2rH6/RBnE0Ne2iACIj0/4stINn9DwlR2sxcGjCz0IKoJEDtBuHQL4Vp8RpgdR6rRcbxV0X72jJYKs46gWCwgYURaaDH1p7Y6WCDK0++ZRDqXXEdnk6DJLBJknBofXFNnkCJIwgVgrs0QQJtqS9WlGkiy5TQRZQkfXdiEAkuzq2KnT0jpEBOnklAsM++pl45HrEBHEy4sXl4tbwV4QHLnOEUG8vCi5eL38pwcMyiAeqErm4QiEQP7rx6kPV4AwoDIIAUSJyCPgWWblR+SfFUH4mEriiRAQQU7kTJnCR0AE4WMqic4IeC3+c2qLIDlUdG5oBHQXa2j3SLlaBJaeUNfKyLVTBsmhonPTIRACefX7FiMYtXS3TSXWCB46qQ5HlkJeEIogXsheXK5XecWGde1hpgjCRlzyDAH6j1FA8JHrD4wnggAF/VERwK/QUAU6Cltaf2BYEcQR/CuKRmk1y9pjrbwSQa4YwY423zOHS2kFtdnl1Vr2wJjKIEBBf80IeP24X7NiBQE12QNd9X/SCwDqdB0CRowQcHUddrbqkT2gqgiy02FX7oZ1Bh4CYq3hTQwPnIPO1d9TEUE8PHAymXZXCoQw044kRq/sAVtFEPP4ibZxIM9uFpscW7IHsNMiffYIkv7VCIAcNXeuYoEiSIyG9odCgJk99pADYIggQ4WElDEEmOSAzK2Zw/QQQQwJbYdBgE2Oll961CJ9mLCQIkCASY69ZVXsCWWQGA3td0VgNHIADGWQriGhwYEAkxiQ11JSoX/8J4LEaGj/cASY5GCUVCkAKrFSRHQ8LQKBbC/sbzIqg0wbDudQPMz6H6+vsDIJSBJejcF7YpsfCuYQVQbJoaJzhyMAohhZGIOzsokIwvCGZNAQYJMEL1q2lF0iCM21EsRCgEkS6NSSTUQQllclh4oASMIkyl6SiCBUt0rYyAjsIYkIMrJHpdun3plEt3lPGIRhpmz+34AITMhhljmjQH3PJFVv+CqDjOK1wfQwkmEbXhW/2Seo+WrXjlSZTVSQpEZ/EaQGJbV5IIDvVeBdJyPMkWRhk8S+a/8wLrMjgmRA0al6BIwsRxGFTZK1ZyQiSH0sqOUCAkcTZUGVTZdQai2RRATZBKcaryEAonhnE3YWAUlKdokgJWR0fjcCIEno/LpbQEVHNklKWUQEqXCGmmxHAIt570yyXatyj1IWEUHKmOlKIwLe5dYRWUQEaQwCdV9G4F5uLTca5Goui4gggzjn5Gq4rkeY2KVrERGEia5kZRHAeiR7gXCSXWalKokgKSI6dkFglgV7WmaJIC7hIKEpAjOtReIySwRJPanj6RDwLLNEkOnCYV6FZyyzRJB54206zcNMX/2vz0YxTgQZxRPSY0gERJAh3XJOpTxv97IRs4W6CMJGVvJOhcAUBPG8S3Eqb17YGK8YmYIgF/a7TK9EwOsOmQhS6QA1uyYCIgjJ7zPewiSZXi3GFr7VHQZoKIIM4ASpMB4CdsdteIJ4zTpeNet4rh5Ho/RFwHE0K2syPEG8QPW661GGWldmxHyVIJjB7cNysVdW2KKfMsgWtK7bdvW3eeMZPAR21e+ZLsFp5LCt1XqlPrPMOmt2lOy7ynn8imHw5RTmBj0f74wtEgRBHAXoa2sQQJ4RbqbvB0zh1cGVjOKIrqlnNVAsse4z/K/Imng/Ol2/a+RAj5rfRa1pUz+6X8t4xvEbZV7Js/jREI4TQZEgofETIVoMzfW1MssUS7ees046lo59EEiqEJ9BHKVmCRKMyhaLCNi1oM7pmiMH2sUZJe23Z5xURunYMyWXxrzw+aeJdmQs0mrgiSClYI6M2mTwWqCXxlsiT6TLELtxSh5CoQGUgN/DJzvRMtXznuz+IgiCtaasqTUcINUEekoS9KvRgwn0XlnpjLNXzpn63f25aSIdxf50snsQpJYcZsgaSWrJYfISkriB6z3jmD1X3MKHiIujJje2L3OT3cdt3q3kMOffSfJ0+3crOUzeXj2sf49tOuP00KHnmOZrkCJ8eqrSPHbOl19gIIxrkP4rBPbP+LlGTVmVG69Rj5xInSMggBgxMebb2FezEwO2BRseDwfNVmxvwXga7femvBjsWDn2/l79SnoA1NysU2qfnr8Hnls5mY53pmO2L+MJPsZp8Ul63LBmPw30NSPS9jVjjNSmhRwj2TGbLmtxtdWeEjkgh0qQVLHZCZDaEx8je8TH2p8TgTU/Pu5izWlevdbsWUfZox57Zsuj/XgJgrBBXZt1mAEhWX8QYPtxqbSyUS9BEDOWtVX2YCFZL6cHOaDd6QnSC9h616vlGgI9fXh6gqyBv+W6SqstaHHa9iQHLPjMVoADC0cK2zaVVhy/1Eph+g+TW82aI9XtCzqFJ+F4ktjyND2V2/2YCS6M2QNudxAmVYDtO5Bj7+T28RwEzg9PdXFf/xRPdT0AnjTWplOb7bvWie3xoBAMCyTBv+s9BUlYkdEy+7B0uIIcNjFYfnsQBE6YnSSjgnyFAG+xkek3FjHMnr8IgpP3Wu0226vnTJCBAxtoyNTfHwSY/oKvIHnvOuOPVs97TwSxJjMt3plgw/7WutUw1PYZAaavjpjEbs8mPJ8ZOZvMBniM7lVed5/ZR8UMEjtyxLtcTNBhq7JG7PH9+0y/eJZOtRZWEQTCbG3Se9ZjOgB2HZGmMc7Z/lr8AMxD/xcjQIyNxzoilr91v6rEygkFUe5GHvKAscUhqf7mmNGckeqp4/4I7CZIrLoXWUSKGGXt90CAQpBUcSMMzofZejXDxETA7J7O7Pey7jEMMtfjINmx7GCnU1l2XlshIASEgBAQAkJACAgBISAEhIAQEAJCQAgIASEgBITAORD4HwMrFgJ59ZwRAAAAAElFTkSuQmCC" alt="bussieck.com"/></a></div><div class="site-mast-right"><a href="https://twitter.com/tryghost" class="site-nav-item" target="_blank" rel="noopener noreferrer"><img class="site-nav-icon" src="/images/icons/twitter.svg" alt="Twitter"/></a><a href="https://www.facebook.com/ghost" class="site-nav-item" target="_blank" rel="noopener noreferrer"><img class="site-nav-icon" src="/images/icons/facebook.svg" alt="Facebook"/></a><a class="site-nav-item" href="https://feedly.com/i/subscription/feed/https://gatsby.ghost.org/rss/" target="_blank" rel="noopener noreferrer"><img class="site-nav-icon" src="/images/icons/rss.svg" alt="RSS Feed"/></a></div></div><nav class="site-nav"><div class="site-nav-left"><a class="site-nav-item" href="/">Home</a><a class="site-nav-item" href="/tag/getting-started/">Tag</a><a class="site-nav-item" href="/author/ghost/">Author</a><a class="site-nav-item" href="https://ghost.org/docs/" target="_blank" rel="noopener noreferrer">Help</a></div><div class="site-nav-right"><a class="site-nav-button" href="/about">About</a></div></nav></div></header><main class="site-main"><div class="container"><article class="content"><figure class="post-feature-image"><img src="https://images.unsplash.com/photo-1556742044-3c52d6e88c62?ixlib=rb-1.2.1&amp;q=80&amp;fm=jpg&amp;crop=entropy&amp;cs=tinysrgb&amp;w=2000&amp;fit=max&amp;ixid=eyJhcHBfaWQiOjExNzczfQ" alt="&#x27;On Writing Software Well&#x27; Part I"/></figure><section class="post-full-content"><h1 class="content-title">&#x27;On Writing Software Well&#x27; Part I</h1><section class="content-body load-external-scripts"><p>DHH has drawn back the curtain on how Basecamp writes software in a video series, tentatively titled 'On Writing Software (well?)', I find it highly instructive and valuable to talk about software design using real world software with alls its trade-offs, necessary messiness and complexity so neatly omitted in your standard textbook toy examples.</p><p>While I do lay out the contents of each episode, this is not a series plain transcript, but rather a way for me to engage with the challenges raised in DHHs examples, add my own thoughts and, at times, contrast his approach with the one we took for <a href="http://speqtor.com">speqtor.com</a> sharing examples from our code base.</p><h2 id="episode-1">Episode 1</h2><p>While Code comments are sometimes necessary to explain certain decisions or trade-offs that aren't obvious from the code, more often than not comments are a kind of code smell. </p><p>You should ask yourself <em>why</em> am I writing this comment? How could the code itself be clearer and not need this comment?</p><p>Every developer is familiar with arcane, outdated comments in the midst of seemingly unrelated code, because the related code had been deleted. Another advantage of self-explanatory code apart from just being clearer (by definition) is that it preempts the problem of code and its explanation getting out of sync.</p><pre><code class="language-ruby">def remove_inaccessible_records
  # 30s of forgiveness in case of accidental removal
  unless person.destroyed? || bucket.destroyed
    Person::RemoveInaccessibleRecordJob.set(wait: 30.seconds).perform_later(person, bucket)
  end
end</code></pre><p>The Basecamp codebase includes a method to remove all inaccessible records after a user has been deleting, because restoring a user's objects in the bucket is cumbersome a 30 second grace period was added in case a user is accidentally removed.</p><p>A comment explains not the control flow, but the configuration of the job.</p><p>We could simply add an <em>explanatory variable</em> elucidating the magic value of 30 seconds and hinting at its purpose.</p><pre><code class="language-ruby">def remove_inaccessible_records
  grace_period_removing_inaccessible_records = 30.seconds

  unless person.destroyed? || bucket.destroyed?
    Person::RemoveInaccessibleRecordJob.set(wait: 30.seconds).perform_later(person, bucket)
  end
end</code></pre><p>However, the value does not vary, so why store it in a variable, it should be a constant. But instead of defining it at the top of the file, as we idiomatically would for public constants in ruby, we should prefer colocating related code and making the constant private.</p><pre><code class="language-ruby">private
GRACE_PERIOD_REMOVING_INACCESSIBLE_RECORDS = 30.seconds

def remove_inaccessible_records
  unless person.destroyed? || bucket.destroyed?
  Person::RemoveInaccessibleRecordJob.set(
    wait: GRACE_PERIOD_REMOVING_INACCESSIBLE_RECORDS
  ).perform_later(person, bucket)
  end
end</code></pre><p>I would go a step further and separate configuration from my app code, especially since often you might want to have different values for different environments, for instance in testing environment you might want the job to execute immediately and not wait 30 seconds.</p><p>More importantly, I have a central place to go looking for configuration options in my applications and they're not scattered across my source code. In Speqtor, for example, we only send out a notification if no new notifications for a user were scheduled within a certain cool down period, so as not to clog up their inbox.</p><p>The config options are defined in <code>config/notifications.yml</code></p><pre><code class="language-ruby">production:
  cool_off_period_in_minutes: 20
development:
  cool_off_period_in_minutes: 0.2
test:
  cool_off_period_in_minutes: 0</code></pre><p>and included it in application.rb  under the rails namespace config.x <a href="https://guides.rubyonrails.org/configuring.html#custom-configuration" rel="noopener noreferrer">for custom configuration.</a></p><p><code>config.x.notification = config_for(:notification)</code></p><p>Back to DHH, who show us an example of how some of his refactorings lead to new features in Rails. In Basecamp there is a join model for granting users administrative access to certain resource and a helper method <code>grant</code> that accepts a <code>person</code> argument and creates an entry for the person in the join model, if an entry already exists it simply returns the person record.</p><p>What might jump out at you about this method is that it commits the sin of using an exception for controlling flow. The dual offense of using framework exceptions in your code is that it also mixes two different levels of abstraction, in this case the top-level ActiveRecord API and constants from the bowels of ActiveRecord.</p><pre><code class="language-ruby">module Account::Administered
  extend ActiveSupport::Concern

  included do
    has_many :administratorships

    def grant(person)
	  create! person: person
        rescue ActiveRecord::RecordNotUnique
        # don't worry about dupes. Treat them the same as successful creation
        where(person: person).take
      end
    end
  end
end</code></pre><p>The reason we are avoiding ActiveRecord's <code>find_or_initialize_by</code> here is that we might end up with stale reads, as <code>find_or_initialize_by</code>  first checks whether a record with the attributes exists using a <code>where</code> query and returns it if it does or else creates one with those attributes.</p><p>In applications with high load this could lead to the result returned by the <code>where</code> clause to being outdated, in which case the create might fail, because the record has already been created in the interim. Hence, we are first attempting to create the record and if that fails because it already exists we simply return it.</p><p>So what we actually want is <code>create_of_find_by(person: person)</code> which encapsulate this behavior and simplifies this code to a mere delegation:</p><pre><code class="language-ruby">def grant(person)
  create_or_find_by(person: person)
end</code></pre><p>And indeed, this method has made it into Rails 6 and it's arguably what <code>find_or_create_by</code> should have been from the beginning.</p><p>Just a note on the topic of exceptions as a flow control; in this instance, I think it is perfectly fine to do so (<a href="https://github.com/rails/rails/blob/f675cb30ce813a99b52b139a93e048330922fd9a/activerecord/lib/active_record/relation.rb#L218">and in fact the Rails method does just that</a>), because we are relying on the database's mechanism for ensuring data consistency and simply pass the exception through to the caller. We could not have performed this check without dealing with the database exception, since this is the only interface offered to our application code.</p></section></section></article></div></main></div><div class="viewport-bottom"><footer class="site-foot"><div class="site-foot-nav container"><div class="site-foot-nav-left"><a href="/">bussieck.com</a> © 2019 — Published with <a class="site-foot-nav-item" href="https://ghost.org" target="_blank" rel="noopener noreferrer">Ghost</a></div><div class="site-foot-nav-right"><a class="site-foot-nav-item" href="/">Home</a><a class="site-foot-nav-item" href="/tag/getting-started/">Tag</a><a class="site-foot-nav-item" href="/author/ghost/">Author</a><a class="site-foot-nav-item" href="https://ghost.org/docs/" target="_blank" rel="noopener noreferrer">Help</a></div></div></footer></div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/on-writing-software-well-part-1/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-4296c3cc3365a22cc881.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-600943d0b42d62cc0e46.js"],"component---src-templates-tag-js":["/component---src-templates-tag-js-136769c7e963230da337.js"],"component---src-templates-author-js":["/component---src-templates-author-js-b788233cd5cd1f5c2648.js"],"component---src-templates-page-js":["/component---src-templates-page-js-54d8e811337c4467e1c6.js"],"component---src-templates-post-js":["/component---src-templates-post-js-9fc98819e1f892725836.js"],"component---src-templates-index-js":["/component---src-templates-index-js-96ea48d98674c6912ae8.js"],"component---src-pages-404-js":["/component---src-pages-404-js-bbbd6654bad647e361bb.js"]};/*]]>*/</script><script src="/component---src-templates-post-js-9fc98819e1f892725836.js" async=""></script><script src="/commons-7ac7283004168054c04b.js" async=""></script><script src="/styles-2acafc6230acb47fb120.js" async=""></script><script src="/app-4296c3cc3365a22cc881.js" async=""></script><script src="/webpack-runtime-f5ff7ac54940d4ab2b0c.js" async=""></script></body></html>